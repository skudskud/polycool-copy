[phases.setup]
nixPkgs = ["...", "python3", "gcc"]

[phases.install]
cmds = [
  "python -m venv --copies /opt/venv && . /opt/venv/bin/activate && pip install -r requirements.txt"
]

[phases.build]
cmds = [
  "pip install -r requirements.txt"
]

[start]
cmd = "uvicorn main:app --host 0.0.0.0 --port $PORT"

# Exclure les variables sensibles du build
[vars]
# Les variables suivantes seront disponibles uniquement au runtime, pas au build
BOT_TOKEN = ""
ENCRYPTION_KEY = ""
JUPITER_API_KEY = ""
OPENAI_API_KEY = ""
SUBSQUID_WEBHOOK_SECRET = ""
TELEGRAM_WEBHOOK_SECRET = ""
TWITTER_ACCESS_SECRET = ""
TWITTER_ACCESS_TOKEN = ""
TWITTER_API_KEY = ""
TWITTER_API_SECRET = ""
WEBHOOK_SECRET = ""

# Variables non-sensibles peuvent être incluses dans le build si nécessaire
DATABASE_URL = ""
REDIS_URL = ""
CLOB_API_KEY = ""
CLOB_API_PASSPHRASE = ""
CLOB_API_SECRET = ""
